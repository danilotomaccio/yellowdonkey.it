import{d as Y,b as D,c as h,h as m,t as S,e as l,k as He,v as Ee,l as w,m as re,w as U,T as Ne,n as M,f as L,q as T,x as We,y as k,z as Ue,F as j,A as G,B as W,C as ke,D as O,a as Pe,E as Ve,H as Re,i as J,I as K,r as ze,J as qe,K as je,L as se,M as Ge}from"./index-6a219ef5.js";const _e=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],Ke=m("option",{value:"mattina"},"Mattina",-1),Je=m("option",{value:"pomeriggio"},"Pomeriggio",-1),Qe=[Ke,Je],Xe=m("button",{type:"submit"},"Conferma",-1),Ze={props:{date:{type:Date,required:!0}},data(){return{timeSlot:"mattina"}},methods:{saveBooking(){this.$emit("save",{date:this.date,timeSlot:this.timeSlot})}}},et=Y({...Ze,__name:"BookSlot",setup(e){return(a,t)=>(D(),h("div",null,[m("h2",null,"Dai la disponibilità per il "+S(e.date.getDate())+" "+S(l(_e)[e.date.getMonth()]),1),m("form",{onSubmit:t[1]||(t[1]=w((...s)=>a.saveBooking&&a.saveBooking(...s),["prevent"]))},[He(m("select",{id:"time-slot","onUpdate:modelValue":t[0]||(t[0]=s=>a.timeSlot=s)},Qe,512),[[Ee,a.timeSlot]]),Xe],32)]))}});const tt={key:0,class:"modal-mask"},at={class:"modal-container"},rt={class:"modal-header"},ot={class:"modal-body"},nt={class:"modal-footer"},it=Y({__name:"Modal",props:{show:Boolean},setup(e){return(a,t)=>(D(),re(Ne,{name:"modal"},{default:U(()=>[e.show?(D(),h("div",tt,[m("div",at,[m("span",{class:"close-modal",onClick:t[0]||(t[0]=s=>a.$emit("close"))},"×"),m("div",rt,[M(a.$slots,"header",{},()=>[T("default header")])]),m("div",ot,[M(a.$slots,"body",{},()=>[T("default body")])]),m("div",nt,[M(a.$slots,"footer",{},()=>[T(" default footer "),m("button",{class:"modal-default-button",onClick:t[1]||(t[1]=s=>a.$emit("close"))},"OK")])])])])):L("",!0)]),_:3}))}});const st={props:{date:{type:Date,required:!0},time:{type:String,required:!0}},data(){return{timeSlot:"mattina"}},methods:{saveBooking(){this.$emit("save",{date:this.date,timeSlot:this.time})}}},lt=Y({...st,__name:"ExistingSlot",setup(e){return(a,t)=>(D(),h("div",null,[m("h2",null,"Dai la disponibilità per il "+S(e.date.getDate())+" "+S(l(_e)[e.date.getMonth()])+" "+S(e.time),1),m("button",{onClick:t[0]||(t[0]=(...s)=>a.saveBooking&&a.saveBooking(...s))},"Conferma")]))}});var dt=Object.defineProperty,ut=(e,a,t)=>a in e?dt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,ae=(e,a,t)=>(ut(e,typeof a!="symbol"?a+"":a,t),t);const X=()=>oe(new Date),ct=(e,a,t)=>{switch(a){case"year":return new Date(e.getFullYear(),0);case"month":return new Date(e.getFullYear(),e.getMonth());case"week":return de(e,t);default:return e}},gt=e=>[...Array(7)].map((a,t)=>V(e,t)),V=(e,a)=>new Date(e.getFullYear(),e.getMonth(),e.getDate()+a,e.getHours(),e.getMinutes(),e.getSeconds()),de=(e,a)=>V(e,(a-e.getDay()-7)%-7),mt=(e,a)=>V(de(e,a),7),Q=e=>new Date(e.getFullYear(),e.getMonth()),pt=e=>Math.ceil(e.getDate()/7),vt=(e,a,t)=>new Date(e.getFullYear()+(a=="year"?t:0),e.getMonth()+(a=="month"?t:0),e.getDate()+(a=="week"?t*7:0)),ue=e=>("0"+String(e.getMonth()+1)).slice(-2),ce=e=>("0"+String(e.getDate())).slice(-2),Se=e=>e.getFullYear()+"-"+ue(e),Dt=e=>Se(e)+"-"+ce(e),ht=e=>ue(e)+"-"+ce(e),ft=(e,a,t)=>{if(e.getHours()===0&&e.getMinutes()===0&&e.getSeconds()===0)return"";if(!ne()){var s=new Date().getTimezoneOffset()*6e4;return new Date(e.getTime()-s).toISOString().slice(11,16)}return e.toLocaleTimeString(a,t)},yt=(e,a,t,s)=>{const g=e.getFullYear()===a.getFullYear(),f=Me(e,a),p=t!=="year"&&t!=="month";let v=[];return v.push(s[e.getMonth()]),p&&(v.push(" "),v.push(e.getDate())),g||(v.push(p?", ":" "),v.push(e.getFullYear())),!f||!g?(v.push(" – "),f||v.push(s[a.getMonth()]),p&&v.push(" ")):p&&v.push(" – "),p?(v.push(a.getDate()),v.push(", ")):v.push(" "),v.push(a.getFullYear()),v.join("")},we=(e,a)=>{const t=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()),s=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());return(t-s)/864e5},bt=(e,a)=>!!e&&!!a&&we(e,a)===0,kt=(e,a)=>!!e&&!!a&&e.getTime()===a.getTime(),Me=(e,a)=>!!e&&!!a&&e.getFullYear()===a.getFullYear()&&e.getMonth()===a.getMonth(),Pt=e=>Q(e)<Q(X()),_t=e=>Q(e)>Q(X()),St=e=>oe(e)>X(),wt=e=>oe(e)<X(),Mt=e=>e.getMonth()!==V(e,7).getMonth(),Ct=e=>e.getMonth()!==V(e,1).getMonth(),Ce=e=>{let a=[...Array(7)].map(t=>0);return e.split(/\D/,7).forEach((t,s)=>a[s]=Number(t)),a[1]--,new Date(a[0],a[1],a[2],a[3],a[4],a[5],a[6])},le=e=>typeof e=="string"?Ce(e):new Date(e),oe=e=>{const a=new Date(e);return a.setHours(0,0,0,0),a},It=e=>e.substring(0,2),ne=()=>typeof Intl<"u",$t=(e,a)=>{if(!ne())return[...Array(12)].map(s=>"");const t=new Intl.DateTimeFormat(e,{month:a});return[...Array(12)].map((s,g)=>t.format(new Date(2017,g,1)))},Ot=(e,a,t)=>{if(!ne())return[...Array(7)].map(g=>"");const s=new Intl.DateTimeFormat(e,{weekday:a});return[...Array(7)].map((g,f)=>s.format(new Date(2017,0,(f+1+t)%7)))},Ft=()=>typeof navigator>"u"?"unk":(navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language).toLowerCase(),At=(e,a)=>{const t=e.classes?[...e.classes]:[];return a&&t.push("isHovered"),{originalItem:e,startDate:le(e.startDate),endDate:le(e.endDate||e.startDate),classes:t,title:e.title||"Untitled",id:e.id,url:e.url,tooltip:e.tooltip??e.title}},o={addDays:V,beginningOfMonth:Q,beginningOfPeriod:ct,beginningOfWeek:de,dateOnly:oe,dayDiff:we,daysOfWeek:gt,endOfWeek:mt,formattedPeriod:yt,formattedTime:ft,fromIsoStringToLocalDate:Ce,getDefaultBrowserLocale:Ft,getFormattedMonthNames:$t,getFormattedWeekdayNames:Ot,incrementPeriod:vt,instanceOfMonth:pt,isFutureMonth:_t,isInFuture:St,isInPast:wt,isLastDayOfMonth:Ct,isLastInstanceOfMonth:Mt,isoMonthDay:ht,isoYearMonth:Se,isoYearMonthDay:Dt,isPastMonth:Pt,isSameDate:bt,isSameDateTime:kt,isSameMonth:Me,languageCode:It,normalizeItem:At,paddedDay:ce,paddedMonth:ue,supportsIntl:ne,today:X,toLocalDate:le};class Lt{constructor(){ae(this,"currentDragItem"),ae(this,"dateSelectionOrigin"),ae(this,"currentHoveredItemId",""),ae(this,"CalendarMath",o)}}const Tt={class:"cv-header-days"},Yt={key:0,class:"cv-weeknumber"},Bt=["aria-multiselectable"],xt={key:0,class:"cv-weeknumber"},Ht={class:"cv-weekdays"},Et=["draggable","aria-grabbed","aria-label","aria-selected","aria-dropeffect","onClick","onDragstart","onDrop","onDragover","onDragenter","onDragleave"],Nt={class:"cv-day-number"},Wt=["draggable","aria-grabbed","title","onDragstart","onMouseenter","onMouseleave","onClick","innerHTML"],Ut=["draggable","aria-grabbed","title","onDragstart","onMouseenter","onMouseleave","onClick"],Vt=Y({__name:"CalendarView",props:{showDate:{default:void 0},displayPeriodUom:{default:"month"},displayPeriodCount:{default:1},displayWeekNumbers:{type:Boolean,default:!1},locale:{default:void 0},monthNameFormat:{default:"long"},weekdayNameFormat:{default:"short"},showTimes:{type:Boolean,default:!1},timeFormatOptions:{default:()=>({})},disablePast:{type:Boolean,default:!1},disableFuture:{type:Boolean,default:!1},enableDateSelection:{type:Boolean,default:!1},selectionStart:{default:void 0},selectionEnd:{default:void 0},enableDragDrop:{type:Boolean,default:!1},startingDayOfWeek:{default:0},items:{default:()=>[]},dateClasses:{default:()=>({})},itemTop:{default:"1.4em"},itemContentHeight:{default:"1.4em"},itemBorderHeight:{default:"2px"},periodChangedCallback:{type:Function,default:void 0},currentPeriodLabel:{default:""},currentPeriodLabelIcons:{default:"⇤-⇥"},doEmitItemMouseEvents:{type:Boolean,default:!1},enableHtmlTitles:{type:Boolean,default:!0}},emits:["period-changed","click-date","click-item","item-mouseenter","item-mouseleave","drag-start","drag-over-date","drag-enter-date","drag-leave-date","drop-on-date","date-selection","date-selection-start","date-selection-finish"],setup(e,{emit:a}){const t=e,s=We(new Lt),g=k(()=>t.locale||o.getDefaultBrowserLocale()),f=k(()=>t.showDate?o.dateOnly(t.showDate):o.today()),p=k(()=>o.beginningOfPeriod(f.value,t.displayPeriodUom,t.startingDayOfWeek)),v=k(()=>o.addDays(o.incrementPeriod(p.value,t.displayPeriodUom,t.displayPeriodCount),-1)),F=k(()=>{const r=o.beginningOfWeek(o.beginningOfPeriod(p.value,"year",0),t.startingDayOfWeek),i=o.beginningOfWeek(p.value,t.startingDayOfWeek);return 1+Math.floor(o.dayDiff(r,i)/7)}),C=k(()=>o.beginningOfWeek(p.value,t.startingDayOfWeek)),I=k(()=>o.endOfWeek(v.value,t.startingDayOfWeek)),B=k(()=>{const r=Math.floor((o.dayDiff(C.value,I.value)+1)/7);return[...Array(r)].map((i,c)=>o.addDays(C.value,c*7))}),y=k(()=>o.getFormattedMonthNames(g.value,t.monthNameFormat)),$=k(()=>o.getFormattedWeekdayNames(g.value,t.weekdayNameFormat,t.startingDayOfWeek)),d=k(()=>t.items?t.items.map(r=>o.normalizeItem(r,r.id===s.currentHoveredItemId)):[]),P=k(()=>o.beginningOfPeriod(o.today(),t.displayPeriodUom,t.startingDayOfWeek)),x=k(()=>o.addDays(o.incrementPeriod(P.value,t.displayPeriodUom,t.displayPeriodCount),-1)),H=k(()=>o.formattedPeriod(p.value,v.value,t.displayPeriodUom,y.value)),R=k(()=>{const r=P.value,i=p.value;return t.currentPeriodLabel?t.currentPeriodLabel==="icons"?t.currentPeriodLabelIcons[Math.sign(r.getTime()-i.getTime())+1]:t.currentPeriodLabel:o.formattedPeriod(r,x.value,t.displayPeriodUom,y.value)}),Z=k(()=>({previousYear:N(-12),previousPeriod:N(-1),nextPeriod:N(1),previousFullPeriod:N(-t.displayPeriodCount),nextFullPeriod:N(t.displayPeriodCount),nextYear:N(12),currentPeriod:P.value,currentPeriodLabel:R.value,periodStart:p.value,periodEnd:v.value,displayLocale:g.value,displayFirstDate:C.value,displayLastDate:I.value,monthNames:y.value,fixedItems:d.value,periodLabel:H.value})),E=k(()=>({periodStart:p,periodEnd:v,displayFirstDate:C,displayLastDate:I}));Ue(()=>E,r=>{t.periodChangedCallback&&(a("period-changed"),t.periodChangedCallback(r,"watch"))},{immediate:!0,deep:!0});const Ie=(r,i)=>{t.disablePast&&o.isInPast(r)||t.disableFuture&&o.isInFuture(r)||a("click-date",r,De(r,r),i)},ge=(r,i)=>a("click-item",r,i),z=r=>"dow"+(r+t.startingDayOfWeek)%7,N=r=>{const i=o.incrementPeriod(p.value,t.displayPeriodUom,r),c=o.incrementPeriod(i,t.displayPeriodUom,t.displayPeriodCount);return t.disablePast&&c<=o.today()||t.disableFuture&&i>o.today()?null:i},me=(r,i)=>{s.currentHoveredItemId=r.id,t.doEmitItemMouseEvents&&a("item-mouseenter",r,i)},pe=(r,i)=>{s.currentHoveredItemId="",t.doEmitItemMouseEvents&&a("item-mouseleave",r,i)},$e=(r,i)=>{var c,b;if(!t.enableDateSelection)return!1;(c=i.dataTransfer)==null||c.setData("text",r.toString());let n=new Image;return n.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",(b=i.dataTransfer)==null||b.setDragImage(n,10,10),s.dateSelectionOrigin=r,a("date-selection-start",ie(r),i),!0},ve=(r,i)=>{var c;return t.enableDragDrop?((c=i.dataTransfer)==null||c.setData("text",r.id),s.currentDragItem=r,s.dateSelectionOrigin=void 0,a("drag-start",r,i),!0):!1},ie=r=>r<=s.dateSelectionOrigin?[r,s.dateSelectionOrigin]:[s.dateSelectionOrigin,r],Oe=(r,i)=>{t.enableDragDrop&&a("drag-over-date",s.currentDragItem,r,i)},Fe=(r,i)=>{t.enableDateSelection&&s.dateSelectionOrigin&&a("date-selection",ie(r),i),t.enableDragDrop&&(a("drag-enter-date",s.currentDragItem,r,i),i.target.classList.add("draghover"))},Ae=(r,i)=>{t.enableDateSelection&&t.selectionStart||!t.enableDragDrop||(a("drag-leave-date",s.currentDragItem,r,i),i.target.classList.remove("draghover"))},Le=(r,i)=>{if(t.enableDateSelection&&s.dateSelectionOrigin){a("date-selection-finish",ie(r),i);return}t.enableDragDrop&&(a("drop-on-date",s.currentDragItem,r,i),i.target.classList.remove("draghover"))},Te=(r,i)=>r.startDate<i.startDate?-1:i.startDate<r.startDate?1:r.endDate>i.endDate?-1:i.endDate>r.endDate?1:r.id<i.id?-1:1,Ye=r=>De(r,o.addDays(r,6)),De=(r,i)=>d.value.filter(c=>c.endDate>=r&&o.dateOnly(c.startDate)<=i,this).sort(Te),Be=r=>!!d.value.find(i=>i.endDate>=r&&o.dateOnly(i.startDate)<=r),he=r=>!(!t.selectionStart||!t.selectionEnd||r<o.dateOnly(t.selectionStart)||r>o.dateOnly(t.selectionEnd)),fe=r=>{const i=Ye(r),c=[],b=[[],[],[],[],[],[],[]];if(!i)return c;for(let n=0;n<i.length;n++){const u=Object.assign({},i[n],{classes:[...i[n].classes],itemRow:0}),_=u.startDate<r,q=_?0:o.dayDiff(r,u.startDate),be=Math.min(7-q,o.dayDiff(o.addDays(r,q),u.endDate)+1);_&&u.classes.push("continued"),o.dayDiff(r,u.endDate)>6&&u.classes.push("toBeContinued"),o.isInPast(u.endDate)&&u.classes.push("past"),u.originalItem.url&&u.classes.push("hasUrl");for(let A=0;A<7;A++)if(A===q){let te=0;for(;b[A][te];)te++;u.itemRow=te,b[A][te]=!0}else A<q+be&&(b[A][u.itemRow]=!0);u.classes.push(`offset${q}`),u.classes.push(`span${be}`),c.push(u)}return c},xe=r=>{const i='<span class="startTime">'+o.formattedTime(r.startDate,g.value,t.timeFormatOptions)+"</span>";let c="";return o.isSameDateTime(r.startDate,r.endDate)||(c='<span class="endTime">'+o.formattedTime(r.endDate,g.value,t.timeFormatOptions)+"</span>"),i+c},ye=r=>t.showTimes?xe(r)+" "+r.title:r.title,ee=r=>{const i=r.itemRow,c=t.itemContentHeight,b=t.itemBorderHeight;return`calc(${t.itemTop} + ${i}*${c} + ${i}*${b})`};return(r,i)=>(D(),h("div",{"aria-label":"Calendar",class:W(["cv-wrapper",`locale-${l(o).languageCode(l(g))}`,`locale-${l(g)}`,`y${l(p).getFullYear()}`,`m${l(o).paddedMonth(l(p))}`,`period-${e.displayPeriodUom}`,`periodCount-${e.displayPeriodCount}`,{past:l(o).isPastMonth(l(p)),future:l(o).isFutureMonth(l(p)),noIntl:!l(o).supportsIntl}])},[M(r.$slots,"header",{headerProps:l(Z)}),m("div",Tt,[e.displayWeekNumbers?(D(),h("div",Yt)):L("",!0),(D(!0),h(j,null,G(l($),(c,b)=>M(r.$slots,"dayHeader",{index:z(b),label:c},()=>[(D(),h("div",{key:z(b),class:W([z(b),"cv-header-day"])},S(c),3))])),256))]),m("div",{"aria-multiselectable":e.enableDateSelection,class:"cv-weeks"},[(D(!0),h(j,null,G(l(B),(c,b)=>(D(),h("div",{key:`${b}-week`,class:W(["cv-week",`week${b+1}`,`ws${l(o).isoYearMonthDay(c)}`])},[e.displayWeekNumbers?(D(),h("div",xt,[M(r.$slots,"weekNumber",{date:c,numberInYear:l(F)+b,numberInPeriod:b+1},()=>[m("span",null,S(l(F)+b),1)])])):L("",!0),m("div",Ht,[(D(!0),h(j,null,G(l(o).daysOfWeek(c),(n,u)=>(D(),h("div",{key:z(u),draggable:e.enableDateSelection,class:W(["cv-day",z(u),`d${l(o).isoYearMonthDay(n)}`,`d${l(o).isoMonthDay(n)}`,`d${l(o).paddedDay(n)}`,`instance${l(o).instanceOfMonth(n)}`,{today:l(o).isSameDate(n,l(o).today()),outsideOfMonth:!l(o).isSameMonth(n,l(f)),past:l(o).isInPast(n),future:l(o).isInFuture(n),last:l(o).isLastDayOfMonth(n),lastInstance:l(o).isLastInstanceOfMonth(n),hasItems:Be(n),selectionStart:l(o).isSameDate(n,e.selectionStart),selectionEnd:l(o).isSameDate(n,e.selectionEnd)},...e.dateClasses&&e.dateClasses[l(o).isoYearMonthDay(n)]||[]]),"aria-grabbed":e.enableDateSelection?he(n):void 0,"aria-label":n.getDate().toString(),"aria-selected":he(n),"aria-dropeffect":e.enableDragDrop&&s.currentDragItem?"move":e.enableDateSelection&&s.dateSelectionOrigin?"execute":"none",onClick:_=>Ie(n,_),onDragstart:_=>$e(n,_),onDrop:w(_=>Le(n,_),["prevent"]),onDragover:w(_=>Oe(n,_),["prevent"]),onDragenter:w(_=>Fe(n,_),["prevent"]),onDragleave:w(_=>Ae(n,_),["prevent"])},[m("div",Nt,S(n.getDate()),1),M(r.$slots,"dayContent",{day:n})],42,Et))),128)),t.enableHtmlTitles?(D(!0),h(j,{key:0},G(fe(c),n=>M(r.$slots,"item",{value:n,weekStartDate:c,top:ee(n)},()=>[(D(),h("div",{key:n.id,draggable:e.enableDragDrop,"aria-grabbed":e.enableDragDrop?n==s.currentDragItem:void 0,class:W([n.classes,"cv-item"]),title:n.tooltip||n.title,style:ke(`top:${ee(n)};${n.originalItem.style}`),onDragstart:u=>ve(n,u),onMouseenter:u=>me(n,u),onMouseleave:u=>pe(n,u),onClick:w(u=>ge(n,u),["stop"]),innerHTML:ye(n)},null,46,Wt))])),256)):(D(!0),h(j,{key:1},G(fe(c),n=>M(r.$slots,"item",{value:n,weekStartDate:c,top:ee(n)},()=>[(D(),h("div",{key:n.id,draggable:e.enableDragDrop,"aria-grabbed":e.enableDragDrop?n==s.currentDragItem:void 0,class:W([n.classes,"cv-item"]),title:n.tooltip||n.title,style:ke(`top:${ee(n)};${n.originalItem.style}`),onDragstart:u=>ve(n,u),onMouseenter:u=>me(n,u),onMouseleave:u=>pe(n,u),onClick:w(u=>ge(n,u),["stop"])},S(ye(n)),47,Ut)),T(" div> ")])),256))])],2))),128))],8,Bt)],2))}}),Rt={class:"cv-header"},zt={class:"cv-header-nav"},qt=["disabled"],jt=["disabled","innerHTML"],Gt=["disabled"],Kt=["disabled"],Jt={class:"periodLabel"},Qt=Y({__name:"CalendarViewHeader",props:{headerProps:{type:Object,required:!0},previousYearLabel:{type:String,default:"<<"},previousPeriodLabel:{type:String,default:"<"},nextPeriodLabel:{type:String,default:">"},nextYearLabel:{type:String,default:">>"}},emits:["input"],setup(e,{emit:a}){const t=s=>a("input",s);return(s,g)=>(D(),h("div",Rt,[m("div",zt,[m("button",{disabled:!e.headerProps.previousYear,class:"previousYear","aria-label":"Previous Year",onClick:g[0]||(g[0]=w(f=>t(e.headerProps.previousYear),["prevent"]))},S(e.previousYearLabel),9,qt),m("button",{disabled:!e.headerProps.previousPeriod,class:"previousPeriod","aria-label":"Previous Period",onClick:g[1]||(g[1]=w(f=>t(e.headerProps.previousPeriod),["prevent"])),innerHTML:e.previousPeriodLabel},null,8,jt),m("button",{class:"currentPeriod","aria-label":"Current Period",onClick:g[2]||(g[2]=w(f=>t(e.headerProps.currentPeriod),["prevent"]))},S(e.headerProps.currentPeriodLabel),1),m("button",{disabled:!e.headerProps.nextPeriod,class:"nextPeriod","aria-label":"Next Period",onClick:g[3]||(g[3]=w(f=>t(e.headerProps.nextPeriod),["prevent"]))},S(e.nextPeriodLabel),9,Gt),m("button",{disabled:!e.headerProps.nextYear,class:"nextYear","aria-label":"Next Year",onClick:g[4]||(g[4]=w(f=>t(e.headerProps.nextYear),["prevent"]))},S(e.nextYearLabel),9,Kt)]),m("div",Jt,[M(s.$slots,"label",{},()=>[T(S(e.headerProps.periodLabel),1)])])]))}}),Xt={class:"calendarContainer"},Zt={id:"calendar-component"},ea=Y({__name:"Calendar",emits:["onClickDay","onClickItem"],setup(e,{emit:a}){var B;let t=O(new Date);(B=Pe().value)==null||B.uid;function s(y){return y.map(d=>{const P=d.id.substring(0,8),x=d.id.charAt(d.id.length-1);let H;if(x==="M")H=8;else if(x==="P")H=15;else throw new Error("Formato ID non riconosciuto");const R=new Date(parseInt(P.substring(0,4),10),parseInt(P.substring(4,6),10)-1,parseInt(P.substring(6,8),10),H),Z=new Date(R);Z.setHours(R.getHours()+4);const E=d.players||d.users;return{id:d.id,startDate:R,endDate:Z,title:E.length>=3?"Al completo":`${3-E.length} posti disponibili`,classes:E.length>=3?"red":"green",slotAvailables:3-E.length}})}const g=Ve(K,"availabilities"),f=Re(g,{wait:!0}),p=k(()=>s(f.value));function v(y,$){return $.filter(d=>d.slotAvailables===0&&d.startDate.getFullYear()===y.getFullYear()&&d.startDate.getMonth()===y.getMonth()&&d.startDate.getDate()===y.getDate())}function F(y){t.value=y}function C(y){v(y,p.value).length>=1||a("onClickDay",y)}function I(y){a("onClickItem",y)}return(y,$)=>(D(),h("div",Xt,[m("div",Zt,[J(l(Vt),{"show-date":l(t),class:"theme-default",onClickDate:C,onClickItem:I,items:p.value,"disable-past":!0,"current-period-label":"icons","display-period-uom":"month"},{header:U(({headerProps:d})=>[J(l(Qt),{"header-props":d,onInput:F},null,8,["header-props"])]),_:1},8,["show-date","items"])])]))}});const ta={class:"availabilityView"},aa=m("div",{class:"istruzioni"}," Per prenotare, clicca su un giorno vuoto o su uno slot già creato ",-1),ra=m("h3",null,"Prenota slot",-1),oa={key:0,class:"clausola"},na={key:0},sa=Y({__name:"AvailabilityView",setup(e){var $;let a=O(!1),t=O(!1),s=O(new Date),g=O("mattina"),f=O(!1),p=O(!1);const v=O(!1),F=($=Pe().value)==null?void 0:$.uid;function C(d,P){return`availabilities/${d.getFullYear()}${(d.getMonth()+1).toString().padStart(2,"0")}${d.getDate().toString().padStart(2,"0")}-${P==="mattina"?"M":"P"}`}async function I(d){f.value=!0,await je(K,async P=>{P.set(se(K,C(d.date,d.timeSlot)),{players:Ge(se(K,`users/${F}`))}),P.set(se(K,`users/${F}/${C(d.date,d.timeSlot)}`),{date:d.date,timeSlot:d.timeSlot})}),v.value=!1,f.value=!1,p.value=!0,t.value=!1,a.value=!1}function B(d){v.value=!0,p.value=!1,s.value=d,t.value=!1,a.value=!0}function y(d){p.value=!1,v.value=!0,d.originalItem.slotAvailables>0&&(g.value=d.id.charAt(d.id.length-1)==="M"?"mattina":"pomeriggio",s.value=d.startDate,t.value=!0,a.value=!1)}return(d,P)=>{const x=ze("RouterLink");return D(),h("div",ta,[aa,J(ea,{onOnClickDay:B,onOnClickItem:y}),(D(),re(qe,{to:"body"},[J(it,{show:v.value,onClose:P[0]||(P[0]=H=>v.value=!1)},{header:U(()=>[ra]),body:U(()=>[l(a)&&!l(f)?(D(),re(et,{key:0,date:l(s),onSave:I},null,8,["date"])):L("",!0),l(t)&&!l(f)?(D(),re(lt,{key:1,date:l(s),time:l(g),onSave:I},null,8,["date","time"])):L("",!0)]),footer:U(()=>[!l(f)&&(l(a)||l(t))?(D(),h("div",oa,[T("Confermando accetti "),J(x,{class:"link",to:"/rules"},{default:U(()=>[T(" il regolamento")]),_:1})])):L("",!0)]),_:1},8,["show"])])),l(p)?(D(),h("div",na,"Prenotato")):L("",!0)])}}});export{sa as default};
