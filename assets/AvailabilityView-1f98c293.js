import{d as N,b as v,c as y,h as u,t as S,e as l,k as Ee,v as Ne,l as M,m as re,w as R,T as We,n as O,q as E,f as H,x as Ue,y as _,z as Ve,F as G,A as J,B as V,C as ke,D as A,a as _e,E as ze,H as z,I as Re,i as X,J as qe,K as Q,r as je,L as Ke,M as Ge,N as Je,O as Qe,P as Pe}from"./index-23c8309f.js";import{m as we}from"./dialog-3944a0f9.js";const Xe=u("option",{value:"mattina"},"Mattina",-1),Ze=u("option",{value:"pomeriggio"},"Pomeriggio",-1),et=[Xe,Ze],tt=u("button",{type:"submit"},"Conferma",-1),at={props:{date:{type:Date,required:!0}},data(){return{timeSlot:"mattina"}},methods:{saveBooking(){this.$emit("save",{date:this.date,timeSlot:this.timeSlot})}}},ot=N({...at,__name:"BookSlot",setup(e){return(a,t)=>(v(),y("div",null,[u("h2",null,"Dai la disponibilità per il "+S(e.date.getDate())+" "+S(l(we)[e.date.getMonth()]),1),u("form",{onSubmit:t[1]||(t[1]=M((...s)=>a.saveBooking&&a.saveBooking(...s),["prevent"]))},[Ee(u("select",{id:"time-slot","onUpdate:modelValue":t[0]||(t[0]=s=>a.timeSlot=s)},et,512),[[Ne,a.timeSlot]]),tt],32)]))}});const rt={key:0,class:"modal-mask"},nt={class:"modal-container"},it={class:"modal-header"},st={class:"modal-body"},lt={class:"modal-footer"},dt=N({__name:"Modal",props:{show:Boolean},setup(e){return(a,t)=>(v(),re(We,{name:"modal"},{default:R(()=>[e.show?(v(),y("div",rt,[u("div",nt,[u("span",{class:"close-modal",onClick:t[0]||(t[0]=s=>a.$emit("close"))},"×"),u("div",it,[O(a.$slots,"header",{},()=>[E("default header")])]),u("div",st,[O(a.$slots,"body",{},()=>[E("default body")])]),u("div",lt,[O(a.$slots,"footer",{},()=>[E(" default footer "),u("button",{class:"modal-default-button",onClick:t[1]||(t[1]=s=>a.$emit("close"))},"OK")])])])])):H("",!0)]),_:3}))}});const ut={props:{date:{type:Date,required:!0},time:{type:String,required:!0}},data(){return{timeSlot:"mattina"}},methods:{saveBooking(){this.$emit("save",{date:this.date,timeSlot:this.time})}}},ct=N({...ut,__name:"ExistingSlot",setup(e){return(a,t)=>(v(),y("div",null,[u("h2",null,"Dai la disponibilità per il "+S(e.date.getDate())+" "+S(l(we)[e.date.getMonth()])+" "+S(e.time),1),u("button",{onClick:t[0]||(t[0]=(...s)=>a.saveBooking&&a.saveBooking(...s))},"Conferma")]))}});var mt=Object.defineProperty,gt=(e,a,t)=>a in e?mt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,oe=(e,a,t)=>(gt(e,typeof a!="symbol"?a+"":a,t),t);const ee=()=>ne(new Date),pt=(e,a,t)=>{switch(a){case"year":return new Date(e.getFullYear(),0);case"month":return new Date(e.getFullYear(),e.getMonth());case"week":return de(e,t);default:return e}},vt=e=>[...Array(7)].map((a,t)=>q(e,t)),q=(e,a)=>new Date(e.getFullYear(),e.getMonth(),e.getDate()+a,e.getHours(),e.getMinutes(),e.getSeconds()),de=(e,a)=>q(e,(a-e.getDay()-7)%-7),Dt=(e,a)=>q(de(e,a),7),Z=e=>new Date(e.getFullYear(),e.getMonth()),ft=e=>Math.ceil(e.getDate()/7),ht=(e,a,t)=>new Date(e.getFullYear()+(a=="year"?t:0),e.getMonth()+(a=="month"?t:0),e.getDate()+(a=="week"?t*7:0)),ue=e=>("0"+String(e.getMonth()+1)).slice(-2),ce=e=>("0"+String(e.getDate())).slice(-2),Se=e=>e.getFullYear()+"-"+ue(e),yt=e=>Se(e)+"-"+ce(e),bt=e=>ue(e)+"-"+ce(e),kt=(e,a,t)=>{if(e.getHours()===0&&e.getMinutes()===0&&e.getSeconds()===0)return"";if(!ie()){var s=new Date().getTimezoneOffset()*6e4;return new Date(e.getTime()-s).toISOString().slice(11,16)}return e.toLocaleTimeString(a,t)},Pt=(e,a,t,s)=>{const m=e.getFullYear()===a.getFullYear(),b=Ce(e,a),g=t!=="year"&&t!=="month";let p=[];return p.push(s[e.getMonth()]),g&&(p.push(" "),p.push(e.getDate())),m||(p.push(g?", ":" "),p.push(e.getFullYear())),!b||!m?(p.push(" – "),b||p.push(s[a.getMonth()]),g&&p.push(" ")):g&&p.push(" – "),g?(p.push(a.getDate()),p.push(", ")):p.push(" "),p.push(a.getFullYear()),p.join("")},Me=(e,a)=>{const t=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()),s=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());return(t-s)/864e5},_t=(e,a)=>!!e&&!!a&&Me(e,a)===0,wt=(e,a)=>!!e&&!!a&&e.getTime()===a.getTime(),Ce=(e,a)=>!!e&&!!a&&e.getFullYear()===a.getFullYear()&&e.getMonth()===a.getMonth(),St=e=>Z(e)<Z(ee()),Mt=e=>Z(e)>Z(ee()),Ct=e=>ne(e)>ee(),It=e=>ne(e)<ee(),$t=e=>e.getMonth()!==q(e,7).getMonth(),Ot=e=>e.getMonth()!==q(e,1).getMonth(),Ie=e=>{let a=[...Array(7)].map(t=>0);return e.split(/\D/,7).forEach((t,s)=>a[s]=Number(t)),a[1]--,new Date(a[0],a[1],a[2],a[3],a[4],a[5],a[6])},le=e=>typeof e=="string"?Ie(e):new Date(e),ne=e=>{const a=new Date(e);return a.setHours(0,0,0,0),a},Ft=e=>e.substring(0,2),ie=()=>typeof Intl<"u",At=(e,a)=>{if(!ie())return[...Array(12)].map(s=>"");const t=new Intl.DateTimeFormat(e,{month:a});return[...Array(12)].map((s,m)=>t.format(new Date(2017,m,1)))},Lt=(e,a,t)=>{if(!ie())return[...Array(7)].map(m=>"");const s=new Intl.DateTimeFormat(e,{weekday:a});return[...Array(7)].map((m,b)=>s.format(new Date(2017,0,(b+1+t)%7)))},Tt=()=>typeof navigator>"u"?"unk":(navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language).toLowerCase(),Yt=(e,a)=>{const t=e.classes?[...e.classes]:[];return a&&t.push("isHovered"),{originalItem:e,startDate:le(e.startDate),endDate:le(e.endDate||e.startDate),classes:t,title:e.title||"Untitled",id:e.id,url:e.url,tooltip:e.tooltip??e.title}},r={addDays:q,beginningOfMonth:Z,beginningOfPeriod:pt,beginningOfWeek:de,dateOnly:ne,dayDiff:Me,daysOfWeek:vt,endOfWeek:Dt,formattedPeriod:Pt,formattedTime:kt,fromIsoStringToLocalDate:Ie,getDefaultBrowserLocale:Tt,getFormattedMonthNames:At,getFormattedWeekdayNames:Lt,incrementPeriod:ht,instanceOfMonth:ft,isFutureMonth:Mt,isInFuture:Ct,isInPast:It,isLastDayOfMonth:Ot,isLastInstanceOfMonth:$t,isoMonthDay:bt,isoYearMonth:Se,isoYearMonthDay:yt,isPastMonth:St,isSameDate:_t,isSameDateTime:wt,isSameMonth:Ce,languageCode:Ft,normalizeItem:Yt,paddedDay:ce,paddedMonth:ue,supportsIntl:ie,today:ee,toLocalDate:le};class Bt{constructor(){oe(this,"currentDragItem"),oe(this,"dateSelectionOrigin"),oe(this,"currentHoveredItemId",""),oe(this,"CalendarMath",r)}}const xt={class:"cv-header-days"},Ht={key:0,class:"cv-weeknumber"},Et=["aria-multiselectable"],Nt={key:0,class:"cv-weeknumber"},Wt={class:"cv-weekdays"},Ut=["draggable","aria-grabbed","aria-label","aria-selected","aria-dropeffect","onClick","onDragstart","onDrop","onDragover","onDragenter","onDragleave"],Vt={class:"cv-day-number"},zt=["draggable","aria-grabbed","title","onDragstart","onMouseenter","onMouseleave","onClick","innerHTML"],Rt=["draggable","aria-grabbed","title","onDragstart","onMouseenter","onMouseleave","onClick"],qt=N({__name:"CalendarView",props:{showDate:{default:void 0},displayPeriodUom:{default:"month"},displayPeriodCount:{default:1},displayWeekNumbers:{type:Boolean,default:!1},locale:{default:void 0},monthNameFormat:{default:"long"},weekdayNameFormat:{default:"short"},showTimes:{type:Boolean,default:!1},timeFormatOptions:{default:()=>({})},disablePast:{type:Boolean,default:!1},disableFuture:{type:Boolean,default:!1},enableDateSelection:{type:Boolean,default:!1},selectionStart:{default:void 0},selectionEnd:{default:void 0},enableDragDrop:{type:Boolean,default:!1},startingDayOfWeek:{default:0},items:{default:()=>[]},dateClasses:{default:()=>({})},itemTop:{default:"1.4em"},itemContentHeight:{default:"1.4em"},itemBorderHeight:{default:"2px"},periodChangedCallback:{type:Function,default:void 0},currentPeriodLabel:{default:""},currentPeriodLabelIcons:{default:"⇤-⇥"},doEmitItemMouseEvents:{type:Boolean,default:!1},enableHtmlTitles:{type:Boolean,default:!0}},emits:["period-changed","click-date","click-item","item-mouseenter","item-mouseleave","drag-start","drag-over-date","drag-enter-date","drag-leave-date","drop-on-date","date-selection","date-selection-start","date-selection-finish"],setup(e,{emit:a}){const t=e,s=Ue(new Bt),m=_(()=>t.locale||r.getDefaultBrowserLocale()),b=_(()=>t.showDate?r.dateOnly(t.showDate):r.today()),g=_(()=>r.beginningOfPeriod(b.value,t.displayPeriodUom,t.startingDayOfWeek)),p=_(()=>r.addDays(r.incrementPeriod(g.value,t.displayPeriodUom,t.displayPeriodCount),-1)),I=_(()=>{const o=r.beginningOfWeek(r.beginningOfPeriod(g.value,"year",0),t.startingDayOfWeek),i=r.beginningOfWeek(g.value,t.startingDayOfWeek);return 1+Math.floor(r.dayDiff(o,i)/7)}),C=_(()=>r.beginningOfWeek(g.value,t.startingDayOfWeek)),L=_(()=>r.endOfWeek(p.value,t.startingDayOfWeek)),T=_(()=>{const o=Math.floor((r.dayDiff(C.value,L.value)+1)/7);return[...Array(o)].map((i,c)=>r.addDays(C.value,c*7))}),f=_(()=>r.getFormattedMonthNames(m.value,t.monthNameFormat)),Y=_(()=>r.getFormattedWeekdayNames(m.value,t.weekdayNameFormat,t.startingDayOfWeek)),k=_(()=>t.items?t.items.map(o=>r.normalizeItem(o,o.id===s.currentHoveredItemId)):[]),$=_(()=>r.beginningOfPeriod(r.today(),t.displayPeriodUom,t.startingDayOfWeek)),D=_(()=>r.addDays(r.incrementPeriod($.value,t.displayPeriodUom,t.displayPeriodCount),-1)),h=_(()=>r.formattedPeriod(g.value,p.value,t.displayPeriodUom,f.value)),F=_(()=>{const o=$.value,i=g.value;return t.currentPeriodLabel?t.currentPeriodLabel==="icons"?t.currentPeriodLabelIcons[Math.sign(o.getTime()-i.getTime())+1]:t.currentPeriodLabel:r.formattedPeriod(o,D.value,t.displayPeriodUom,f.value)}),B=_(()=>({previousYear:U(-12),previousPeriod:U(-1),nextPeriod:U(1),previousFullPeriod:U(-t.displayPeriodCount),nextFullPeriod:U(t.displayPeriodCount),nextYear:U(12),currentPeriod:$.value,currentPeriodLabel:F.value,periodStart:g.value,periodEnd:p.value,displayLocale:m.value,displayFirstDate:C.value,displayLastDate:L.value,monthNames:f.value,fixedItems:k.value,periodLabel:h.value})),W=_(()=>({periodStart:g,periodEnd:p,displayFirstDate:C,displayLastDate:L}));Ve(()=>W,o=>{t.periodChangedCallback&&(a("period-changed"),t.periodChangedCallback(o,"watch"))},{immediate:!0,deep:!0});const $e=(o,i)=>{t.disablePast&&r.isInPast(o)||t.disableFuture&&r.isInFuture(o)||a("click-date",o,De(o,o),i)},me=(o,i)=>a("click-item",o,i),j=o=>"dow"+(o+t.startingDayOfWeek)%7,U=o=>{const i=r.incrementPeriod(g.value,t.displayPeriodUom,o),c=r.incrementPeriod(i,t.displayPeriodUom,t.displayPeriodCount);return t.disablePast&&c<=r.today()||t.disableFuture&&i>r.today()?null:i},ge=(o,i)=>{s.currentHoveredItemId=o.id,t.doEmitItemMouseEvents&&a("item-mouseenter",o,i)},pe=(o,i)=>{s.currentHoveredItemId="",t.doEmitItemMouseEvents&&a("item-mouseleave",o,i)},Oe=(o,i)=>{var c,P;if(!t.enableDateSelection)return!1;(c=i.dataTransfer)==null||c.setData("text",o.toString());let n=new Image;return n.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",(P=i.dataTransfer)==null||P.setDragImage(n,10,10),s.dateSelectionOrigin=o,a("date-selection-start",se(o),i),!0},ve=(o,i)=>{var c;return t.enableDragDrop?((c=i.dataTransfer)==null||c.setData("text",o.id),s.currentDragItem=o,s.dateSelectionOrigin=void 0,a("drag-start",o,i),!0):!1},se=o=>o<=s.dateSelectionOrigin?[o,s.dateSelectionOrigin]:[s.dateSelectionOrigin,o],Fe=(o,i)=>{t.enableDragDrop&&a("drag-over-date",s.currentDragItem,o,i)},Ae=(o,i)=>{t.enableDateSelection&&s.dateSelectionOrigin&&a("date-selection",se(o),i),t.enableDragDrop&&(a("drag-enter-date",s.currentDragItem,o,i),i.target.classList.add("draghover"))},Le=(o,i)=>{t.enableDateSelection&&t.selectionStart||!t.enableDragDrop||(a("drag-leave-date",s.currentDragItem,o,i),i.target.classList.remove("draghover"))},Te=(o,i)=>{if(t.enableDateSelection&&s.dateSelectionOrigin){a("date-selection-finish",se(o),i);return}t.enableDragDrop&&(a("drop-on-date",s.currentDragItem,o,i),i.target.classList.remove("draghover"))},Ye=(o,i)=>o.startDate<i.startDate?-1:i.startDate<o.startDate?1:o.endDate>i.endDate?-1:i.endDate>o.endDate?1:o.id<i.id?-1:1,Be=o=>De(o,r.addDays(o,6)),De=(o,i)=>k.value.filter(c=>c.endDate>=o&&r.dateOnly(c.startDate)<=i,this).sort(Ye),xe=o=>!!k.value.find(i=>i.endDate>=o&&r.dateOnly(i.startDate)<=o),fe=o=>!(!t.selectionStart||!t.selectionEnd||o<r.dateOnly(t.selectionStart)||o>r.dateOnly(t.selectionEnd)),he=o=>{const i=Be(o),c=[],P=[[],[],[],[],[],[],[]];if(!i)return c;for(let n=0;n<i.length;n++){const d=Object.assign({},i[n],{classes:[...i[n].classes],itemRow:0}),w=d.startDate<o,K=w?0:r.dayDiff(o,d.startDate),be=Math.min(7-K,r.dayDiff(r.addDays(o,K),d.endDate)+1);w&&d.classes.push("continued"),r.dayDiff(o,d.endDate)>6&&d.classes.push("toBeContinued"),r.isInPast(d.endDate)&&d.classes.push("past"),d.originalItem.url&&d.classes.push("hasUrl");for(let x=0;x<7;x++)if(x===K){let ae=0;for(;P[x][ae];)ae++;d.itemRow=ae,P[x][ae]=!0}else x<K+be&&(P[x][d.itemRow]=!0);d.classes.push(`offset${K}`),d.classes.push(`span${be}`),c.push(d)}return c},He=o=>{const i='<span class="startTime">'+r.formattedTime(o.startDate,m.value,t.timeFormatOptions)+"</span>";let c="";return r.isSameDateTime(o.startDate,o.endDate)||(c='<span class="endTime">'+r.formattedTime(o.endDate,m.value,t.timeFormatOptions)+"</span>"),i+c},ye=o=>t.showTimes?He(o)+" "+o.title:o.title,te=o=>{const i=o.itemRow,c=t.itemContentHeight,P=t.itemBorderHeight;return`calc(${t.itemTop} + ${i}*${c} + ${i}*${P})`};return(o,i)=>(v(),y("div",{"aria-label":"Calendar",class:V(["cv-wrapper",`locale-${l(r).languageCode(l(m))}`,`locale-${l(m)}`,`y${l(g).getFullYear()}`,`m${l(r).paddedMonth(l(g))}`,`period-${e.displayPeriodUom}`,`periodCount-${e.displayPeriodCount}`,{past:l(r).isPastMonth(l(g)),future:l(r).isFutureMonth(l(g)),noIntl:!l(r).supportsIntl}])},[O(o.$slots,"header",{headerProps:l(B)}),u("div",xt,[e.displayWeekNumbers?(v(),y("div",Ht)):H("",!0),(v(!0),y(G,null,J(l(Y),(c,P)=>O(o.$slots,"dayHeader",{index:j(P),label:c},()=>[(v(),y("div",{key:j(P),class:V([j(P),"cv-header-day"])},S(c),3))])),256))]),u("div",{"aria-multiselectable":e.enableDateSelection,class:"cv-weeks"},[(v(!0),y(G,null,J(l(T),(c,P)=>(v(),y("div",{key:`${P}-week`,class:V(["cv-week",`week${P+1}`,`ws${l(r).isoYearMonthDay(c)}`])},[e.displayWeekNumbers?(v(),y("div",Nt,[O(o.$slots,"weekNumber",{date:c,numberInYear:l(I)+P,numberInPeriod:P+1},()=>[u("span",null,S(l(I)+P),1)])])):H("",!0),u("div",Wt,[(v(!0),y(G,null,J(l(r).daysOfWeek(c),(n,d)=>(v(),y("div",{key:j(d),draggable:e.enableDateSelection,class:V(["cv-day",j(d),`d${l(r).isoYearMonthDay(n)}`,`d${l(r).isoMonthDay(n)}`,`d${l(r).paddedDay(n)}`,`instance${l(r).instanceOfMonth(n)}`,{today:l(r).isSameDate(n,l(r).today()),outsideOfMonth:!l(r).isSameMonth(n,l(b)),past:l(r).isInPast(n),future:l(r).isInFuture(n),last:l(r).isLastDayOfMonth(n),lastInstance:l(r).isLastInstanceOfMonth(n),hasItems:xe(n),selectionStart:l(r).isSameDate(n,e.selectionStart),selectionEnd:l(r).isSameDate(n,e.selectionEnd)},...e.dateClasses&&e.dateClasses[l(r).isoYearMonthDay(n)]||[]]),"aria-grabbed":e.enableDateSelection?fe(n):void 0,"aria-label":n.getDate().toString(),"aria-selected":fe(n),"aria-dropeffect":e.enableDragDrop&&s.currentDragItem?"move":e.enableDateSelection&&s.dateSelectionOrigin?"execute":"none",onClick:w=>$e(n,w),onDragstart:w=>Oe(n,w),onDrop:M(w=>Te(n,w),["prevent"]),onDragover:M(w=>Fe(n,w),["prevent"]),onDragenter:M(w=>Ae(n,w),["prevent"]),onDragleave:M(w=>Le(n,w),["prevent"])},[u("div",Vt,S(n.getDate()),1),O(o.$slots,"dayContent",{day:n})],42,Ut))),128)),t.enableHtmlTitles?(v(!0),y(G,{key:0},J(he(c),n=>O(o.$slots,"item",{value:n,weekStartDate:c,top:te(n)},()=>[(v(),y("div",{key:n.id,draggable:e.enableDragDrop,"aria-grabbed":e.enableDragDrop?n==s.currentDragItem:void 0,class:V([n.classes,"cv-item"]),title:n.tooltip||n.title,style:ke(`top:${te(n)};${n.originalItem.style}`),onDragstart:d=>ve(n,d),onMouseenter:d=>ge(n,d),onMouseleave:d=>pe(n,d),onClick:M(d=>me(n,d),["stop"]),innerHTML:ye(n)},null,46,zt))])),256)):(v(!0),y(G,{key:1},J(he(c),n=>O(o.$slots,"item",{value:n,weekStartDate:c,top:te(n)},()=>[(v(),y("div",{key:n.id,draggable:e.enableDragDrop,"aria-grabbed":e.enableDragDrop?n==s.currentDragItem:void 0,class:V([n.classes,"cv-item"]),title:n.tooltip||n.title,style:ke(`top:${te(n)};${n.originalItem.style}`),onDragstart:d=>ve(n,d),onMouseenter:d=>ge(n,d),onMouseleave:d=>pe(n,d),onClick:M(d=>me(n,d),["stop"])},S(ye(n)),47,Rt)),E(" div> ")])),256))])],2))),128))],8,Et)],2))}}),jt={class:"cv-header"},Kt={class:"cv-header-nav"},Gt=["disabled"],Jt=["disabled","innerHTML"],Qt=["disabled"],Xt=["disabled"],Zt={class:"periodLabel"},ea=N({__name:"CalendarViewHeader",props:{headerProps:{type:Object,required:!0},previousYearLabel:{type:String,default:"<<"},previousPeriodLabel:{type:String,default:"<"},nextPeriodLabel:{type:String,default:">"},nextYearLabel:{type:String,default:">>"}},emits:["input"],setup(e,{emit:a}){const t=s=>a("input",s);return(s,m)=>(v(),y("div",jt,[u("div",Kt,[u("button",{disabled:!e.headerProps.previousYear,class:"previousYear","aria-label":"Previous Year",onClick:m[0]||(m[0]=M(b=>t(e.headerProps.previousYear),["prevent"]))},S(e.previousYearLabel),9,Gt),u("button",{disabled:!e.headerProps.previousPeriod,class:"previousPeriod","aria-label":"Previous Period",onClick:m[1]||(m[1]=M(b=>t(e.headerProps.previousPeriod),["prevent"])),innerHTML:e.previousPeriodLabel},null,8,Jt),u("button",{class:"currentPeriod","aria-label":"Current Period",onClick:m[2]||(m[2]=M(b=>t(e.headerProps.currentPeriod),["prevent"]))},S(e.headerProps.currentPeriodLabel),1),u("button",{disabled:!e.headerProps.nextPeriod,class:"nextPeriod","aria-label":"Next Period",onClick:m[3]||(m[3]=M(b=>t(e.headerProps.nextPeriod),["prevent"]))},S(e.nextPeriodLabel),9,Qt),u("button",{disabled:!e.headerProps.nextYear,class:"nextYear","aria-label":"Next Year",onClick:m[4]||(m[4]=M(b=>t(e.headerProps.nextYear),["prevent"]))},S(e.nextYearLabel),9,Xt)]),u("div",Zt,[O(s.$slots,"label",{},()=>[E(S(e.headerProps.periodLabel),1)])])]))}}),ta={class:"calendarContainer"},aa={id:"calendar-component"},oa=N({__name:"Calendar",emits:["onClickDay","onClickItem"],setup(e,{emit:a}){var T;let t=A(new Date);(T=_e().value)==null||T.uid;function s(f){return f.map(k=>{const $=k.id.substring(0,8),D=k.id.charAt(k.id.length-1);let h;if(D==="M")h=8;else if(D==="P")h=15;else throw new Error("Formato ID non riconosciuto");const F=new Date(parseInt($.substring(0,4),10),parseInt($.substring(4,6),10)-1,parseInt($.substring(6,8),10),h),B=new Date(F);B.setHours(F.getHours()+4);const W=k.players||k.users;return{id:k.id,startDate:F,endDate:B,title:W.length>=3?"Al completo":`${3-W.length} posti disponibili`,classes:W.length>=3?"red":"green",slotAvailables:3-W.length}})}const m=ze(z,"availabilities"),b=Re(m,{wait:!0}),g=_(()=>s(b.value));function p(f,Y){return Y.filter(k=>k.slotAvailables===0&&k.startDate.getFullYear()===f.getFullYear()&&k.startDate.getMonth()===f.getMonth()&&k.startDate.getDate()===f.getDate())}function I(f){t.value=f}function C(f){p(f,g.value).length>=1||a("onClickDay",f)}function L(f){f.originalItem.slotAvailables<=0||f.startDate<new Date||a("onClickItem",f)}return(f,Y)=>(v(),y("div",ta,[u("div",aa,[X(l(qt),{"show-date":l(t),class:"theme-default",onClickDate:C,onClickItem:L,items:g.value,"disable-past":!0,"current-period-label":"icons","display-period-uom":"month"},{header:R(({headerProps:k})=>[X(l(ea),{"header-props":k,onInput:I},null,8,["header-props"])]),_:1},8,["show-date","items"])])]))}});const ra={class:"availabilityView"},na=u("div",{class:"istruzioni"}," Per prenotare, clicca su un giorno vuoto o su uno slot già creato ",-1),ia=["open"],sa=u("div",{slot:"headline"},"Non puoi prenotare",-1),la=u("form",{id:"form",slot:"content",method:"dialog"}," Hai ricevuto due o più ammonizioni e non puoi più prenotare. Dai un'occhiata al regolamento se vuoi sapere come ridurre le tue ammonizioni. ",-1),da={slot:"actions"},ua=u("h3",null,"Prenota slot",-1),ca={key:0,class:"clausola"},ma={key:0},va=N({__name:"AvailabilityView",setup(e){var $;const a=A(!1),t=A(!1),s=A(new Date),m=A("mattina"),b=A(!1),g=A(!1),p=A(!1),I=A(!1),C=($=_e().value)==null?void 0:$.uid,L=qe(Q(z,`users/${C}`));function T(D,h){return`availabilities/${D.getFullYear()}${(D.getMonth()+1).toString().padStart(2,"0")}${D.getDate().toString().padStart(2,"0")}-${h==="mattina"?"M":"P"}`}async function f(D){b.value=!0;const h=Q(z,T(D.date,D.timeSlot)),F=Q(z,`users/${C}/${T(D.date,D.timeSlot)}`);(await Ge(h)).exists()?Je(h,{players:Qe(Q(z,`users/${C}`))}):Pe(h,{players:[Q(z,`users/${C}`)]}),Pe(F,{date:D.date,timeSlot:D.timeSlot}),I.value=!1,b.value=!1,g.value=!0,t.value=!1,a.value=!1}function Y(D){var h;if(((h=L.value)==null?void 0:h.admonitionCount)>=2){p.value=!0;return}I.value=!0,g.value=!1,s.value=D,t.value=!1,a.value=!0}function k(D){var h;if(((h=L.value)==null?void 0:h.admonitionCount)>=2){p.value=!0;return}g.value=!1,I.value=!0,D.originalItem.slotAvailables>0&&(m.value=D.id.charAt(D.id.length-1)==="M"?"mattina":"pomeriggio",s.value=D.startDate,t.value=!0,a.value=!1)}return(D,h)=>{const F=je("RouterLink");return v(),y("div",ra,[na,X(oa,{onOnClickDay:Y,onOnClickItem:k}),u("md-dialog",{type:"alert",open:p.value},[sa,la,u("div",da,[u("md-text-button",{form:"form",value:"ok",onClick:h[0]||(h[0]=B=>p.value=!1)},"OK")])],8,ia),(v(),re(Ke,{to:"body"},[X(dt,{show:I.value,onClose:h[1]||(h[1]=B=>I.value=!1)},{header:R(()=>[ua]),body:R(()=>[a.value&&!b.value?(v(),re(ot,{key:0,date:s.value,onSave:f},null,8,["date"])):H("",!0),t.value&&!b.value?(v(),re(ct,{key:1,date:s.value,time:m.value,onSave:f},null,8,["date","time"])):H("",!0)]),footer:R(()=>[!b.value&&(a.value||t.value)?(v(),y("div",ca,[E("Confermando accetti "),X(F,{class:"link",to:"/rules"},{default:R(()=>[E(" il regolamento")]),_:1})])):H("",!0)]),_:1},8,["show"])])),g.value?(v(),y("div",ma,"Prenotato")):H("",!0)])}}});export{va as default};
