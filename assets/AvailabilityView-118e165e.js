import{d as x,b as D,c as h,h as m,t as S,e as l,k as Ee,v as Ne,l as w,m as oe,w as U,T as We,n as M,f as Y,q as B,x as Ue,y as k,z as Ve,F as j,A as K,B as W,C as ke,D as A,a as _e,E as Re,H as G,I as ze,i as J,r as qe,J as je,K as ae,L as Ke,M as Ge,N as Je,O as Pe}from"./index-1480ac81.js";import{m as Se}from"./costants-37b51c58.js";const Qe=m("option",{value:"mattina"},"Mattina",-1),Xe=m("option",{value:"pomeriggio"},"Pomeriggio",-1),Ze=[Qe,Xe],et=m("button",{type:"submit"},"Conferma",-1),tt={props:{date:{type:Date,required:!0}},data(){return{timeSlot:"mattina"}},methods:{saveBooking(){this.$emit("save",{date:this.date,timeSlot:this.timeSlot})}}},at=x({...tt,__name:"BookSlot",setup(e){return(a,t)=>(D(),h("div",null,[m("h2",null,"Dai la disponibilità per il "+S(e.date.getDate())+" "+S(l(Se)[e.date.getMonth()]),1),m("form",{onSubmit:t[1]||(t[1]=w((...s)=>a.saveBooking&&a.saveBooking(...s),["prevent"]))},[Ee(m("select",{id:"time-slot","onUpdate:modelValue":t[0]||(t[0]=s=>a.timeSlot=s)},Ze,512),[[Ne,a.timeSlot]]),et],32)]))}});const rt={key:0,class:"modal-mask"},ot={class:"modal-container"},nt={class:"modal-header"},it={class:"modal-body"},st={class:"modal-footer"},lt=x({__name:"Modal",props:{show:Boolean},setup(e){return(a,t)=>(D(),oe(We,{name:"modal"},{default:U(()=>[e.show?(D(),h("div",rt,[m("div",ot,[m("span",{class:"close-modal",onClick:t[0]||(t[0]=s=>a.$emit("close"))},"×"),m("div",nt,[M(a.$slots,"header",{},()=>[B("default header")])]),m("div",it,[M(a.$slots,"body",{},()=>[B("default body")])]),m("div",st,[M(a.$slots,"footer",{},()=>[B(" default footer "),m("button",{class:"modal-default-button",onClick:t[1]||(t[1]=s=>a.$emit("close"))},"OK")])])])])):Y("",!0)]),_:3}))}});const dt={props:{date:{type:Date,required:!0},time:{type:String,required:!0}},data(){return{timeSlot:"mattina"}},methods:{saveBooking(){this.$emit("save",{date:this.date,timeSlot:this.time})}}},ut=x({...dt,__name:"ExistingSlot",setup(e){return(a,t)=>(D(),h("div",null,[m("h2",null,"Dai la disponibilità per il "+S(e.date.getDate())+" "+S(l(Se)[e.date.getMonth()])+" "+S(e.time),1),m("button",{onClick:t[0]||(t[0]=(...s)=>a.saveBooking&&a.saveBooking(...s))},"Conferma")]))}});var ct=Object.defineProperty,gt=(e,a,t)=>a in e?ct(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,re=(e,a,t)=>(gt(e,typeof a!="symbol"?a+"":a,t),t);const X=()=>ne(new Date),mt=(e,a,t)=>{switch(a){case"year":return new Date(e.getFullYear(),0);case"month":return new Date(e.getFullYear(),e.getMonth());case"week":return de(e,t);default:return e}},pt=e=>[...Array(7)].map((a,t)=>V(e,t)),V=(e,a)=>new Date(e.getFullYear(),e.getMonth(),e.getDate()+a,e.getHours(),e.getMinutes(),e.getSeconds()),de=(e,a)=>V(e,(a-e.getDay()-7)%-7),vt=(e,a)=>V(de(e,a),7),Q=e=>new Date(e.getFullYear(),e.getMonth()),Dt=e=>Math.ceil(e.getDate()/7),ht=(e,a,t)=>new Date(e.getFullYear()+(a=="year"?t:0),e.getMonth()+(a=="month"?t:0),e.getDate()+(a=="week"?t*7:0)),ue=e=>("0"+String(e.getMonth()+1)).slice(-2),ce=e=>("0"+String(e.getDate())).slice(-2),we=e=>e.getFullYear()+"-"+ue(e),ft=e=>we(e)+"-"+ce(e),yt=e=>ue(e)+"-"+ce(e),bt=(e,a,t)=>{if(e.getHours()===0&&e.getMinutes()===0&&e.getSeconds()===0)return"";if(!ie()){var s=new Date().getTimezoneOffset()*6e4;return new Date(e.getTime()-s).toISOString().slice(11,16)}return e.toLocaleTimeString(a,t)},kt=(e,a,t,s)=>{const g=e.getFullYear()===a.getFullYear(),f=Ce(e,a),p=t!=="year"&&t!=="month";let v=[];return v.push(s[e.getMonth()]),p&&(v.push(" "),v.push(e.getDate())),g||(v.push(p?", ":" "),v.push(e.getFullYear())),!f||!g?(v.push(" – "),f||v.push(s[a.getMonth()]),p&&v.push(" ")):p&&v.push(" – "),p?(v.push(a.getDate()),v.push(", ")):v.push(" "),v.push(a.getFullYear()),v.join("")},Me=(e,a)=>{const t=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()),s=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());return(t-s)/864e5},Pt=(e,a)=>!!e&&!!a&&Me(e,a)===0,_t=(e,a)=>!!e&&!!a&&e.getTime()===a.getTime(),Ce=(e,a)=>!!e&&!!a&&e.getFullYear()===a.getFullYear()&&e.getMonth()===a.getMonth(),St=e=>Q(e)<Q(X()),wt=e=>Q(e)>Q(X()),Mt=e=>ne(e)>X(),Ct=e=>ne(e)<X(),It=e=>e.getMonth()!==V(e,7).getMonth(),$t=e=>e.getMonth()!==V(e,1).getMonth(),Ie=e=>{let a=[...Array(7)].map(t=>0);return e.split(/\D/,7).forEach((t,s)=>a[s]=Number(t)),a[1]--,new Date(a[0],a[1],a[2],a[3],a[4],a[5],a[6])},le=e=>typeof e=="string"?Ie(e):new Date(e),ne=e=>{const a=new Date(e);return a.setHours(0,0,0,0),a},Ot=e=>e.substring(0,2),ie=()=>typeof Intl<"u",Ft=(e,a)=>{if(!ie())return[...Array(12)].map(s=>"");const t=new Intl.DateTimeFormat(e,{month:a});return[...Array(12)].map((s,g)=>t.format(new Date(2017,g,1)))},At=(e,a,t)=>{if(!ie())return[...Array(7)].map(g=>"");const s=new Intl.DateTimeFormat(e,{weekday:a});return[...Array(7)].map((g,f)=>s.format(new Date(2017,0,(f+1+t)%7)))},Lt=()=>typeof navigator>"u"?"unk":(navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language).toLowerCase(),Tt=(e,a)=>{const t=e.classes?[...e.classes]:[];return a&&t.push("isHovered"),{originalItem:e,startDate:le(e.startDate),endDate:le(e.endDate||e.startDate),classes:t,title:e.title||"Untitled",id:e.id,url:e.url,tooltip:e.tooltip??e.title}},o={addDays:V,beginningOfMonth:Q,beginningOfPeriod:mt,beginningOfWeek:de,dateOnly:ne,dayDiff:Me,daysOfWeek:pt,endOfWeek:vt,formattedPeriod:kt,formattedTime:bt,fromIsoStringToLocalDate:Ie,getDefaultBrowserLocale:Lt,getFormattedMonthNames:Ft,getFormattedWeekdayNames:At,incrementPeriod:ht,instanceOfMonth:Dt,isFutureMonth:wt,isInFuture:Mt,isInPast:Ct,isLastDayOfMonth:$t,isLastInstanceOfMonth:It,isoMonthDay:yt,isoYearMonth:we,isoYearMonthDay:ft,isPastMonth:St,isSameDate:Pt,isSameDateTime:_t,isSameMonth:Ce,languageCode:Ot,normalizeItem:Tt,paddedDay:ce,paddedMonth:ue,supportsIntl:ie,today:X,toLocalDate:le};class Yt{constructor(){re(this,"currentDragItem"),re(this,"dateSelectionOrigin"),re(this,"currentHoveredItemId",""),re(this,"CalendarMath",o)}}const Bt={class:"cv-header-days"},xt={key:0,class:"cv-weeknumber"},Ht=["aria-multiselectable"],Et={key:0,class:"cv-weeknumber"},Nt={class:"cv-weekdays"},Wt=["draggable","aria-grabbed","aria-label","aria-selected","aria-dropeffect","onClick","onDragstart","onDrop","onDragover","onDragenter","onDragleave"],Ut={class:"cv-day-number"},Vt=["draggable","aria-grabbed","title","onDragstart","onMouseenter","onMouseleave","onClick","innerHTML"],Rt=["draggable","aria-grabbed","title","onDragstart","onMouseenter","onMouseleave","onClick"],zt=x({__name:"CalendarView",props:{showDate:{default:void 0},displayPeriodUom:{default:"month"},displayPeriodCount:{default:1},displayWeekNumbers:{type:Boolean,default:!1},locale:{default:void 0},monthNameFormat:{default:"long"},weekdayNameFormat:{default:"short"},showTimes:{type:Boolean,default:!1},timeFormatOptions:{default:()=>({})},disablePast:{type:Boolean,default:!1},disableFuture:{type:Boolean,default:!1},enableDateSelection:{type:Boolean,default:!1},selectionStart:{default:void 0},selectionEnd:{default:void 0},enableDragDrop:{type:Boolean,default:!1},startingDayOfWeek:{default:0},items:{default:()=>[]},dateClasses:{default:()=>({})},itemTop:{default:"1.4em"},itemContentHeight:{default:"1.4em"},itemBorderHeight:{default:"2px"},periodChangedCallback:{type:Function,default:void 0},currentPeriodLabel:{default:""},currentPeriodLabelIcons:{default:"⇤-⇥"},doEmitItemMouseEvents:{type:Boolean,default:!1},enableHtmlTitles:{type:Boolean,default:!0}},emits:["period-changed","click-date","click-item","item-mouseenter","item-mouseleave","drag-start","drag-over-date","drag-enter-date","drag-leave-date","drop-on-date","date-selection","date-selection-start","date-selection-finish"],setup(e,{emit:a}){const t=e,s=Ue(new Yt),g=k(()=>t.locale||o.getDefaultBrowserLocale()),f=k(()=>t.showDate?o.dateOnly(t.showDate):o.today()),p=k(()=>o.beginningOfPeriod(f.value,t.displayPeriodUom,t.startingDayOfWeek)),v=k(()=>o.addDays(o.incrementPeriod(p.value,t.displayPeriodUom,t.displayPeriodCount),-1)),I=k(()=>{const r=o.beginningOfWeek(o.beginningOfPeriod(p.value,"year",0),t.startingDayOfWeek),i=o.beginningOfWeek(p.value,t.startingDayOfWeek);return 1+Math.floor(o.dayDiff(r,i)/7)}),C=k(()=>o.beginningOfWeek(p.value,t.startingDayOfWeek)),$=k(()=>o.endOfWeek(v.value,t.startingDayOfWeek)),H=k(()=>{const r=Math.floor((o.dayDiff(C.value,$.value)+1)/7);return[...Array(r)].map((i,c)=>o.addDays(C.value,c*7))}),y=k(()=>o.getFormattedMonthNames(g.value,t.monthNameFormat)),O=k(()=>o.getFormattedWeekdayNames(g.value,t.weekdayNameFormat,t.startingDayOfWeek)),d=k(()=>t.items?t.items.map(r=>o.normalizeItem(r,r.id===s.currentHoveredItemId)):[]),P=k(()=>o.beginningOfPeriod(o.today(),t.displayPeriodUom,t.startingDayOfWeek)),F=k(()=>o.addDays(o.incrementPeriod(P.value,t.displayPeriodUom,t.displayPeriodCount),-1)),L=k(()=>o.formattedPeriod(p.value,v.value,t.displayPeriodUom,y.value)),R=k(()=>{const r=P.value,i=p.value;return t.currentPeriodLabel?t.currentPeriodLabel==="icons"?t.currentPeriodLabelIcons[Math.sign(r.getTime()-i.getTime())+1]:t.currentPeriodLabel:o.formattedPeriod(r,F.value,t.displayPeriodUom,y.value)}),Z=k(()=>({previousYear:N(-12),previousPeriod:N(-1),nextPeriod:N(1),previousFullPeriod:N(-t.displayPeriodCount),nextFullPeriod:N(t.displayPeriodCount),nextYear:N(12),currentPeriod:P.value,currentPeriodLabel:R.value,periodStart:p.value,periodEnd:v.value,displayLocale:g.value,displayFirstDate:C.value,displayLastDate:$.value,monthNames:y.value,fixedItems:d.value,periodLabel:L.value})),E=k(()=>({periodStart:p,periodEnd:v,displayFirstDate:C,displayLastDate:$}));Ve(()=>E,r=>{t.periodChangedCallback&&(a("period-changed"),t.periodChangedCallback(r,"watch"))},{immediate:!0,deep:!0});const $e=(r,i)=>{t.disablePast&&o.isInPast(r)||t.disableFuture&&o.isInFuture(r)||a("click-date",r,De(r,r),i)},ge=(r,i)=>a("click-item",r,i),z=r=>"dow"+(r+t.startingDayOfWeek)%7,N=r=>{const i=o.incrementPeriod(p.value,t.displayPeriodUom,r),c=o.incrementPeriod(i,t.displayPeriodUom,t.displayPeriodCount);return t.disablePast&&c<=o.today()||t.disableFuture&&i>o.today()?null:i},me=(r,i)=>{s.currentHoveredItemId=r.id,t.doEmitItemMouseEvents&&a("item-mouseenter",r,i)},pe=(r,i)=>{s.currentHoveredItemId="",t.doEmitItemMouseEvents&&a("item-mouseleave",r,i)},Oe=(r,i)=>{var c,b;if(!t.enableDateSelection)return!1;(c=i.dataTransfer)==null||c.setData("text",r.toString());let n=new Image;return n.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",(b=i.dataTransfer)==null||b.setDragImage(n,10,10),s.dateSelectionOrigin=r,a("date-selection-start",se(r),i),!0},ve=(r,i)=>{var c;return t.enableDragDrop?((c=i.dataTransfer)==null||c.setData("text",r.id),s.currentDragItem=r,s.dateSelectionOrigin=void 0,a("drag-start",r,i),!0):!1},se=r=>r<=s.dateSelectionOrigin?[r,s.dateSelectionOrigin]:[s.dateSelectionOrigin,r],Fe=(r,i)=>{t.enableDragDrop&&a("drag-over-date",s.currentDragItem,r,i)},Ae=(r,i)=>{t.enableDateSelection&&s.dateSelectionOrigin&&a("date-selection",se(r),i),t.enableDragDrop&&(a("drag-enter-date",s.currentDragItem,r,i),i.target.classList.add("draghover"))},Le=(r,i)=>{t.enableDateSelection&&t.selectionStart||!t.enableDragDrop||(a("drag-leave-date",s.currentDragItem,r,i),i.target.classList.remove("draghover"))},Te=(r,i)=>{if(t.enableDateSelection&&s.dateSelectionOrigin){a("date-selection-finish",se(r),i);return}t.enableDragDrop&&(a("drop-on-date",s.currentDragItem,r,i),i.target.classList.remove("draghover"))},Ye=(r,i)=>r.startDate<i.startDate?-1:i.startDate<r.startDate?1:r.endDate>i.endDate?-1:i.endDate>r.endDate?1:r.id<i.id?-1:1,Be=r=>De(r,o.addDays(r,6)),De=(r,i)=>d.value.filter(c=>c.endDate>=r&&o.dateOnly(c.startDate)<=i,this).sort(Ye),xe=r=>!!d.value.find(i=>i.endDate>=r&&o.dateOnly(i.startDate)<=r),he=r=>!(!t.selectionStart||!t.selectionEnd||r<o.dateOnly(t.selectionStart)||r>o.dateOnly(t.selectionEnd)),fe=r=>{const i=Be(r),c=[],b=[[],[],[],[],[],[],[]];if(!i)return c;for(let n=0;n<i.length;n++){const u=Object.assign({},i[n],{classes:[...i[n].classes],itemRow:0}),_=u.startDate<r,q=_?0:o.dayDiff(r,u.startDate),be=Math.min(7-q,o.dayDiff(o.addDays(r,q),u.endDate)+1);_&&u.classes.push("continued"),o.dayDiff(r,u.endDate)>6&&u.classes.push("toBeContinued"),o.isInPast(u.endDate)&&u.classes.push("past"),u.originalItem.url&&u.classes.push("hasUrl");for(let T=0;T<7;T++)if(T===q){let te=0;for(;b[T][te];)te++;u.itemRow=te,b[T][te]=!0}else T<q+be&&(b[T][u.itemRow]=!0);u.classes.push(`offset${q}`),u.classes.push(`span${be}`),c.push(u)}return c},He=r=>{const i='<span class="startTime">'+o.formattedTime(r.startDate,g.value,t.timeFormatOptions)+"</span>";let c="";return o.isSameDateTime(r.startDate,r.endDate)||(c='<span class="endTime">'+o.formattedTime(r.endDate,g.value,t.timeFormatOptions)+"</span>"),i+c},ye=r=>t.showTimes?He(r)+" "+r.title:r.title,ee=r=>{const i=r.itemRow,c=t.itemContentHeight,b=t.itemBorderHeight;return`calc(${t.itemTop} + ${i}*${c} + ${i}*${b})`};return(r,i)=>(D(),h("div",{"aria-label":"Calendar",class:W(["cv-wrapper",`locale-${l(o).languageCode(l(g))}`,`locale-${l(g)}`,`y${l(p).getFullYear()}`,`m${l(o).paddedMonth(l(p))}`,`period-${e.displayPeriodUom}`,`periodCount-${e.displayPeriodCount}`,{past:l(o).isPastMonth(l(p)),future:l(o).isFutureMonth(l(p)),noIntl:!l(o).supportsIntl}])},[M(r.$slots,"header",{headerProps:l(Z)}),m("div",Bt,[e.displayWeekNumbers?(D(),h("div",xt)):Y("",!0),(D(!0),h(j,null,K(l(O),(c,b)=>M(r.$slots,"dayHeader",{index:z(b),label:c},()=>[(D(),h("div",{key:z(b),class:W([z(b),"cv-header-day"])},S(c),3))])),256))]),m("div",{"aria-multiselectable":e.enableDateSelection,class:"cv-weeks"},[(D(!0),h(j,null,K(l(H),(c,b)=>(D(),h("div",{key:`${b}-week`,class:W(["cv-week",`week${b+1}`,`ws${l(o).isoYearMonthDay(c)}`])},[e.displayWeekNumbers?(D(),h("div",Et,[M(r.$slots,"weekNumber",{date:c,numberInYear:l(I)+b,numberInPeriod:b+1},()=>[m("span",null,S(l(I)+b),1)])])):Y("",!0),m("div",Nt,[(D(!0),h(j,null,K(l(o).daysOfWeek(c),(n,u)=>(D(),h("div",{key:z(u),draggable:e.enableDateSelection,class:W(["cv-day",z(u),`d${l(o).isoYearMonthDay(n)}`,`d${l(o).isoMonthDay(n)}`,`d${l(o).paddedDay(n)}`,`instance${l(o).instanceOfMonth(n)}`,{today:l(o).isSameDate(n,l(o).today()),outsideOfMonth:!l(o).isSameMonth(n,l(f)),past:l(o).isInPast(n),future:l(o).isInFuture(n),last:l(o).isLastDayOfMonth(n),lastInstance:l(o).isLastInstanceOfMonth(n),hasItems:xe(n),selectionStart:l(o).isSameDate(n,e.selectionStart),selectionEnd:l(o).isSameDate(n,e.selectionEnd)},...e.dateClasses&&e.dateClasses[l(o).isoYearMonthDay(n)]||[]]),"aria-grabbed":e.enableDateSelection?he(n):void 0,"aria-label":n.getDate().toString(),"aria-selected":he(n),"aria-dropeffect":e.enableDragDrop&&s.currentDragItem?"move":e.enableDateSelection&&s.dateSelectionOrigin?"execute":"none",onClick:_=>$e(n,_),onDragstart:_=>Oe(n,_),onDrop:w(_=>Te(n,_),["prevent"]),onDragover:w(_=>Fe(n,_),["prevent"]),onDragenter:w(_=>Ae(n,_),["prevent"]),onDragleave:w(_=>Le(n,_),["prevent"])},[m("div",Ut,S(n.getDate()),1),M(r.$slots,"dayContent",{day:n})],42,Wt))),128)),t.enableHtmlTitles?(D(!0),h(j,{key:0},K(fe(c),n=>M(r.$slots,"item",{value:n,weekStartDate:c,top:ee(n)},()=>[(D(),h("div",{key:n.id,draggable:e.enableDragDrop,"aria-grabbed":e.enableDragDrop?n==s.currentDragItem:void 0,class:W([n.classes,"cv-item"]),title:n.tooltip||n.title,style:ke(`top:${ee(n)};${n.originalItem.style}`),onDragstart:u=>ve(n,u),onMouseenter:u=>me(n,u),onMouseleave:u=>pe(n,u),onClick:w(u=>ge(n,u),["stop"]),innerHTML:ye(n)},null,46,Vt))])),256)):(D(!0),h(j,{key:1},K(fe(c),n=>M(r.$slots,"item",{value:n,weekStartDate:c,top:ee(n)},()=>[(D(),h("div",{key:n.id,draggable:e.enableDragDrop,"aria-grabbed":e.enableDragDrop?n==s.currentDragItem:void 0,class:W([n.classes,"cv-item"]),title:n.tooltip||n.title,style:ke(`top:${ee(n)};${n.originalItem.style}`),onDragstart:u=>ve(n,u),onMouseenter:u=>me(n,u),onMouseleave:u=>pe(n,u),onClick:w(u=>ge(n,u),["stop"])},S(ye(n)),47,Rt)),B(" div> ")])),256))])],2))),128))],8,Ht)],2))}}),qt={class:"cv-header"},jt={class:"cv-header-nav"},Kt=["disabled"],Gt=["disabled","innerHTML"],Jt=["disabled"],Qt=["disabled"],Xt={class:"periodLabel"},Zt=x({__name:"CalendarViewHeader",props:{headerProps:{type:Object,required:!0},previousYearLabel:{type:String,default:"<<"},previousPeriodLabel:{type:String,default:"<"},nextPeriodLabel:{type:String,default:">"},nextYearLabel:{type:String,default:">>"}},emits:["input"],setup(e,{emit:a}){const t=s=>a("input",s);return(s,g)=>(D(),h("div",qt,[m("div",jt,[m("button",{disabled:!e.headerProps.previousYear,class:"previousYear","aria-label":"Previous Year",onClick:g[0]||(g[0]=w(f=>t(e.headerProps.previousYear),["prevent"]))},S(e.previousYearLabel),9,Kt),m("button",{disabled:!e.headerProps.previousPeriod,class:"previousPeriod","aria-label":"Previous Period",onClick:g[1]||(g[1]=w(f=>t(e.headerProps.previousPeriod),["prevent"])),innerHTML:e.previousPeriodLabel},null,8,Gt),m("button",{class:"currentPeriod","aria-label":"Current Period",onClick:g[2]||(g[2]=w(f=>t(e.headerProps.currentPeriod),["prevent"]))},S(e.headerProps.currentPeriodLabel),1),m("button",{disabled:!e.headerProps.nextPeriod,class:"nextPeriod","aria-label":"Next Period",onClick:g[3]||(g[3]=w(f=>t(e.headerProps.nextPeriod),["prevent"]))},S(e.nextPeriodLabel),9,Jt),m("button",{disabled:!e.headerProps.nextYear,class:"nextYear","aria-label":"Next Year",onClick:g[4]||(g[4]=w(f=>t(e.headerProps.nextYear),["prevent"]))},S(e.nextYearLabel),9,Qt)]),m("div",Xt,[M(s.$slots,"label",{},()=>[B(S(e.headerProps.periodLabel),1)])])]))}}),ea={class:"calendarContainer"},ta={id:"calendar-component"},aa=x({__name:"Calendar",emits:["onClickDay","onClickItem"],setup(e,{emit:a}){var H;let t=A(new Date);(H=_e().value)==null||H.uid;function s(y){return y.map(d=>{const P=d.id.substring(0,8),F=d.id.charAt(d.id.length-1);let L;if(F==="M")L=8;else if(F==="P")L=15;else throw new Error("Formato ID non riconosciuto");const R=new Date(parseInt(P.substring(0,4),10),parseInt(P.substring(4,6),10)-1,parseInt(P.substring(6,8),10),L),Z=new Date(R);Z.setHours(R.getHours()+4);const E=d.players||d.users;return{id:d.id,startDate:R,endDate:Z,title:E.length>=3?"Al completo":`${3-E.length} posti disponibili`,classes:E.length>=3?"red":"green",slotAvailables:3-E.length}})}const g=Re(G,"availabilities"),f=ze(g,{wait:!0}),p=k(()=>s(f.value));function v(y,O){return O.filter(d=>d.slotAvailables===0&&d.startDate.getFullYear()===y.getFullYear()&&d.startDate.getMonth()===y.getMonth()&&d.startDate.getDate()===y.getDate())}function I(y){t.value=y}function C(y){v(y,p.value).length>=1||a("onClickDay",y)}function $(y){y.originalItem.slotAvailables<=0||a("onClickItem",y)}return(y,O)=>(D(),h("div",ea,[m("div",ta,[J(l(zt),{"show-date":l(t),class:"theme-default",onClickDate:C,onClickItem:$,items:p.value,"disable-past":!0,"current-period-label":"icons","display-period-uom":"month"},{header:U(({headerProps:d})=>[J(l(Zt),{"header-props":d,onInput:I},null,8,["header-props"])]),_:1},8,["show-date","items"])])]))}});const ra={class:"availabilityView"},oa=m("div",{class:"istruzioni"}," Per prenotare, clicca su un giorno vuoto o su uno slot già creato ",-1),na=m("h3",null,"Prenota slot",-1),ia={key:0,class:"clausola"},sa={key:0},ua=x({__name:"AvailabilityView",setup(e){var O;let a=A(!1),t=A(!1),s=A(new Date),g=A("mattina"),f=A(!1),p=A(!1);const v=A(!1),I=(O=_e().value)==null?void 0:O.uid;function C(d,P){return`availabilities/${d.getFullYear()}${(d.getMonth()+1).toString().padStart(2,"0")}${d.getDate().toString().padStart(2,"0")}-${P==="mattina"?"M":"P"}`}async function $(d){f.value=!0;const P=ae(G,C(d.date,d.timeSlot)),F=ae(G,`users/${I}/${C(d.date,d.timeSlot)}`);(await Ke(P)).exists()?Ge(P,{players:Je(ae(G,`users/${I}`))}):Pe(P,{players:[ae(G,`users/${I}`)]}),Pe(F,{date:d.date,timeSlot:d.timeSlot}),v.value=!1,f.value=!1,p.value=!0,t.value=!1,a.value=!1}function H(d){v.value=!0,p.value=!1,s.value=d,t.value=!1,a.value=!0}function y(d){p.value=!1,v.value=!0,d.originalItem.slotAvailables>0&&(g.value=d.id.charAt(d.id.length-1)==="M"?"mattina":"pomeriggio",s.value=d.startDate,t.value=!0,a.value=!1)}return(d,P)=>{const F=qe("RouterLink");return D(),h("div",ra,[oa,J(aa,{onOnClickDay:H,onOnClickItem:y}),(D(),oe(je,{to:"body"},[J(lt,{show:v.value,onClose:P[0]||(P[0]=L=>v.value=!1)},{header:U(()=>[na]),body:U(()=>[l(a)&&!l(f)?(D(),oe(at,{key:0,date:l(s),onSave:$},null,8,["date"])):Y("",!0),l(t)&&!l(f)?(D(),oe(ut,{key:1,date:l(s),time:l(g),onSave:$},null,8,["date","time"])):Y("",!0)]),footer:U(()=>[!l(f)&&(l(a)||l(t))?(D(),h("div",ia,[B("Confermando accetti "),J(F,{class:"link",to:"/rules"},{default:U(()=>[B(" il regolamento")]),_:1})])):Y("",!0)]),_:1},8,["show"])])),l(p)?(D(),h("div",sa,"Prenotato")):Y("",!0)])}}});export{ua as default};
